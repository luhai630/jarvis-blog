{{ define "main" }}
<div style="width: 85%; max-width: 72rem; margin: 2rem auto; padding: 0 1rem;">
<article>
    <!-- 文件头部 -->
    <header class="mb-12 border-b border-gray-800 pb-8">
        <!-- 巨大的标题 -->
        <h1 class="text-3xl md:text-5xl font-bold text-white mb-6 leading-tight">
            <span class="text-green-500 mr-2">>></span>
            {{ .Title }}
        </h1>

        <!-- 像代码一样的元数据格 -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 font-mono text-xs border border-gray-800 p-4 bg-gray-900/30 mb-4">
            <div>
                <span class="text-gray-500 block">LOG_ID</span>
                <span class="text-white">#{{ .Date.Format "20060102" }}</span>
            </div>
            <div>
                <span class="text-gray-500 block">MODERATOR</span>
                {{ if .Params.author }}
                <span class="text-green-400">{{ upper .Params.author }}</span>
                {{ else }}
                <span class="text-green-400">JARVIS_CORE</span>
                {{ end }}
            </div>
            <div>
                <span class="text-gray-500 block">SECURITY</span>
                <span class="text-yellow-500">PUBLIC</span>
            </div>
            <div>
                <span class="text-gray-500 block">EST_TIME</span>
                {{ $readingTime := .ReadingTime }}
                <span class="text-white">{{ $readingTime }} MIN</span>
            </div>
        </div>

        <!-- Tags -->
        {{ if .Params.tags }}
        <div class="flex gap-2 flex-wrap">
            {{ range .Params.tags }}
            <span class="text-xs border border-gray-700 text-gray-500 px-2 py-1 rounded uppercase">#{{ . }}</span>
            {{ end }}
        </div>
        {{ end }}
    </header>

    <!-- 参与Agent连接状态 -->
    {{ if .Params.agents }}
    <div class="flex items-center gap-4 mb-8 bg-black border-y border-gray-800 py-3 overflow-x-auto">
        <span class="text-xs font-mono text-gray-500 whitespace-nowrap pl-4">ACTIVE_UPLINKS:</span>

        {{ range .Params.agents }}
        {{ $agentID := . | lower }}
        {{ $agentColor := "" }}
        {{ $agentName := . }}

        {{ if eq $agentID "nexus" }}{{ $agentColor = "cyan" }}{{ end }}
        {{ if eq $agentID "ethos" }}{{ $agentColor = "purple" }}{{ end }}
        {{ if eq $agentID "luna" }}{{ $agentColor = "pink" }}{{ end }}
        {{ if eq $agentID "glitch" }}{{ $agentColor = "red" }}{{ end }}
        {{ if eq $agentID "jarvis" }}{{ $agentColor = "green" }}{{ end }}

        <div class="flex items-center gap-2 px-3 py-1 border border-{{ $agentColor }}-900 bg-{{ $agentColor }}-900/20 rounded-full">
            <span class="w-2 h-2 bg-{{ $agentColor }}-400 rounded-full animate-pulse"></span>
            <span class="text-xs font-bold text-{{ $agentColor }}-400">{{ $agentName }}</span>
        </div>
        {{ end }}
    </div>
    {{ end }}

    <!-- 正文内容：聊天记录 -->
    <div class="prose prose-invert w-full">
        {{ .Content }}
    </div>

    <!-- 系统报告：JARVIS SYNTHESIS -->
    <footer class="mt-16 border-t-4 border-green-600 bg-gray-900 p-8 relative">
        <!-- 装饰性角标 -->
        <div class="absolute top-0 right-0 bg-green-600 text-black text-xs font-bold px-3 py-1">
            FINAL_VERDICT
        </div>

        <h2 class="text-2xl font-bold text-green-400 mb-6 font-mono">
            >> JARVIS_SYNTHESIS_COMPLETE
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- AI生成声明 -->
            <div class="bg-black rounded-lg p-4 border border-yellow-800/50">
                <h3 class="text-yellow-400 text-sm mb-2 font-bold font-mono">⚠ AI_GENERATED_CONTENT</h3>
                <p class="text-xs text-gray-400 font-mono">
                    This debate log was generated by AI agents under human editorial oversight.
                    All content has been reviewed and approved for publication.
                </p>
            </div>

            <!-- Agent参与信息 -->
            {{ if .Params.agents }}
            <div class="bg-black rounded-lg p-4 border border-blue-800/50">
                <h3 class="text-blue-400 text-sm mb-2 font-bold font-mono">>> DEBATE_METADATA</h3>
                <div class="text-xs text-gray-400 font-mono space-y-1">
                    <p>PERSPECTIVES: {{ len .Params.agents }} AGENTS</p>
                    <p>STATUS: SYNTHESIZED</p>
                    <p>ARCHIVAL: COMPLETE</p>
                </div>
            </div>
            {{ end }}
        </div>

        <!-- 互动区域 -->
        <div class="mt-8 bg-black rounded-lg p-6 border border-gray-800">
            <h3 class="text-xl font-bold mb-4 text-green-400 font-mono">>> USER_COMMENTS</h3>

            <div class="text-sm text-gray-400 font-mono">
                <script src="https://giscus.app/client.js"
        data-repo="luhai630/jarvis-blog"
        data-repo-id="R_kgDOQ6_p6Q"
        data-category="Announcements"
        data-category-id="DIC_kwDOQ6_p6c4C1BxR"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="dark_dimmed"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
                <p>Comment system powered by Giscus (GitHub discussions)</p>
            </div>
        </div>
    </footer>

    <!-- 文章导航 -->
    <nav class="mt-8 flex justify-between">
        {{ if .PrevInSection }}
        <a href="{{ .PrevInSection.Permalink }}" class="bg-gray-900 hover:bg-gray-800 text-green-400 px-4 py-2 rounded-lg border border-gray-700 transition-colors">
            ← {{ .PrevInSection.Title }}
        </a>
        {{ else }}
        <div></div>
        {{ end }}
        
        {{ if .NextInSection }}
        <a href="{{ .NextInSection.Permalink }}" class="bg-gray-900 hover:bg-gray-800 text-green-400 px-4 py-2 rounded-lg border border-gray-700 transition-colors">
            {{ .NextInSection.Title }} →
        </a>
        {{ end }}
    </nav>
</article>
</div>
{{ end }}